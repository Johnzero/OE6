# -*- coding: utf-8 -*-

<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<title>产品清单</title>
		<style type="text/css">
			table
			{
			    border-collapse:collapse;
			}
			table, td, th
			{
			    border:1px solid #ccc;
			}
			
		</style>
		<script language="javascript" src="/web_lodop/static/src/js/LodopFuncs.js"></script>
		<object id="LODOP_OB" classid="clsid:2105C259-1E0C-4534-8141-A753534CB4CA" width=0 height=0>
			<embed id="LODOP_EM" type="application/x-print-lodop" width=0 height=0 pluginspage="/web_lodop/static/src/js/install_lodop.exe"></embed>
		</object>
	</head>
	<body>
        % if len(objects) > 1:
			目前不支持多单据打印.
		% else:
    		% for o in objects:
    		    % if o['state'] == 'done':
    		    <div id="x">
    		        <div id="header">
    		            <table border="0" cellspacing="2" width="100%">
        					<tr>
        						<td colspan="3"></td>
        						<td colspan="3">
        							<p align="center" style="font-size:18px;"><b>产品清单</b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>
        						</td>
        						<td colspan="2">
        							<div style="text-align:right;font-size:12px;">
        								单号: ${ o['name'] } <br/>
        								副单号: ${ o.sub_name }
        							</div>
        						</td>
        					</tr>
        					<tr style="font-size:14px;">
                                <td colspan="3">部门名称: <span style="text-decoration:underline;">${ o.partner_id.name }</span> 经理</td>
                                <td colspan="3">备注: <span style="text-decoration:underline;">${ o.note or '' }</span></td>
                                <td colspan="2" align="right">日期: <span style="text-decoration:underline;">${ o.date_order }</span></td>
        					</tr>
        				</table>
    		        </div>
    		        <div id="table">
    		          <table border="1" cellspace="2" width="100%" style="border-collapse:collapse" bordercolor="#333">
    		              <thead>
      						<tr>
      							<td align="center" width="30">行号</td>
      							<td align="center" width="60">品名</td>
      							<td align="center" width="60">型号</td>
      							<td align="center">单位</td>
      							<td align="center">数量</td>
      							<td align="center">单价</td>
      							<td align="center" width="80" >金额</td>
      							<td align="center" width="50" >备注</td>
      						</tr>
      					</thead>
      					<tbody>
    						<%
    							i = 0
    						%>
    						% for line in o.order_line:
                              <% i = i + 1 %>
                              <tr>
                                  <td width="5%" height="16" style="font-size:13px;">${ i }</td>
                                  <td width="20%" height="16" style="font-size:13px;">${ line.product_id.name }</td>
                                  <td width="10%" height="16" style="font-size:13px;">${ line.product_id.default_code or '' }</td>
                                  <td width="10%" height="16" style="font-size:13px;">${ line.product_uom.name }</td>
                                  <td width="10%" height="16" style="font-size:13px;">${ line.product_uom_qty }</td>
                                  <td width="10%" height="16" style="font-size:13px;">${ line.unit_price }</td>
                                  <td width="10%" height="16" style="font-size:13px;">${ line.subtotal_amount }</td>
                                  <td width="25%" height="16" style="font-size:13px;">${ line.note or '' }</td>
                                </tr>
                              % endfor
						</tbody>
    		          </table>
    		        </div>
    		        
    		        <div id="footer">
        				<table border="0" cellspacing="2" width="100%">
        					<tr>
        						<td colspan="2" style="font-size:13px;">开票人: ${ o['user_id']['name'] }</td>
						        <td colspan="2" style="font-size:13px;">审核人: ${ o['confirmer_id']['name'] }</td>
        						<td colspan="2" style="font-size:13px;">客户签收: </td>
        					</tr>
        				</table>
        			</div>
                    
                </div>
                    <script language="javascript" type="text/javascript">
            		    var LODOP; //声明为全局变量
            		    function print_all(){
                        		LODOP=getLodop(document.getElementById('LODOP'),document.getElementById('LODOP_EM'));  
                        		LODOP.SET_LICENSES("","292881049110510152101109126561","","");
                        		LODOP.PRINT_INIT("FG ERP Order");
                        		LODOP.SET_PRINT_PAGESIZE(1, 2300, 1300, 'fg_sale_order_order');
                        		LODOP.ADD_PRINT_HTM("0mm", "0mm", "220mm", "20mm",document.getElementById("header").innerHTML);
                                LODOP.SET_PRINT_STYLEA(0,"ItemType",1);
                				LODOP.SET_PRINT_STYLEA(0,"LinkedItem",1);
                				LODOP.SET_PRINT_STYLEA(0,"Horient",2);

                				LODOP.ADD_PRINT_HTM("120mm","0mm","160mm","16mm",document.getElementById("footer").innerHTML);
                				LODOP.SET_PRINT_STYLEA(0,"ItemType",1);
                				LODOP.SET_PRINT_STYLEA(0,"LinkedItem",1);
                				
                				LODOP.ADD_PRINT_TABLE("18.5mm", "5.8mm", "220mm", "88mm",document.getElementById("table").innerHTML);
                				LODOP.SET_PRINT_STYLEA(0,"Horient",2);
                				
                				
                				
                				LODOP.ADD_PRINT_TEXT("117mm","184mm","15mm","5mm","第#页/共&页");
                				LODOP.SET_PRINT_STYLEA(0,"ItemType",2);

                				LODOP.NewPageA();
                        		//LODOP.PREVIEW();
                        		LODOP.PRINT_DESIGN();
                        		window.close();
                        }
                        
                        print_all();
        		    </script>
        		% endif
        	% endfor
		% endif 
        </body>
</html>